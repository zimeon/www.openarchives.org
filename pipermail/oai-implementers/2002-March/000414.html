<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OAI-implementers] Better resumption mechanism - more importa
 nt than ever!
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:liu_x%40cs.odu.edu">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000412.html">
   <LINK REL="Next"  HREF="000415.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OAI-implementers] Better resumption mechanism - more importa
 nt than ever!
   </H1>
    <B>Xiaoming Liu
    </B> 
    <A HREF="mailto:liu_x%40cs.odu.edu"
       TITLE="[OAI-implementers] Better resumption mechanism - more importa
 nt than ever!">liu_x@cs.odu.edu
       </A><BR>
    <I>Tue, 5 Mar 2002 17:04:18 -0500 (EST)</I>
    <P><UL>
        <LI> Previous message: <A HREF="000412.html">[OAI-implementers] Better resumption mechanism - more importa
 nt than ever!
</A></li>
        <LI> Next message: <A HREF="000415.html">[OAI-implementers] Better resumption mechanism - more importa nt than ever!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#414">[ date ]</a>
              <a href="thread.html#414">[ thread ]</a>
              <a href="subject.html#414">[ subject ]</a>
              <a href="author.html#414">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>On Tue, 5 Mar 2002, Simeon Warner wrote:

&gt;<i> 
</I>&gt;<i> Liu, your policy is the sort of thing I had imagined. However, I'm curious
</I>&gt;<i> about how frequently you find that a sequence of harvests fails. When I
</I>&gt;<i> last did an extensive harvest (last summer) I found that, provided
</I>&gt;<i> repositories had implemented the protocol properly, I rarely had problems
</I>&gt;<i> getting successful responses to complete a List request. Can you give us
</I>&gt;<i> some (approximate) statistics?
</I>

I did the last extensive (historical) harvest from Feb,5. Usually this is
not a problem in our daily (fresh) harvesting. The result may be the
problem in my side.

Five archives failed in a sequence of harvesting (using resumptionToken),
including: cimi, etdcat, conoze, dlpscoll, hsss. I did not dig into the
details however. See harvest log below:

etdcat: 
<A HREF="http://alcme.oclc.org/etdcat/servlet/OAIHandler?verb=ListRecords&resumptionToken=1013006344644%3A22000%3Aoai_dc">http://alcme.oclc.org/etdcat/servlet/OAIHandler?verb=ListRecords&amp;resumptionToken=1013006344644%3A22000%3Aoai_dc</A>
Wed Feb 06 09:40:20 EST 2002
java.net.SocketException: errno: 101, error: Network is unreachable for
fd: 11
java.net.SocketException: errno: 101, error: Network is unreachable for
fd: 11/

hsss:

<A HREF="http://hsss.slub-dresden.de/hsss/servlet/hsss.oai.OAIServlet?verb=ListRecords&resumptionToken=rt10130378386093615p9">http://hsss.slub-dresden.de/hsss/servlet/hsss.oai.OAIServlet?verb=ListRecords&amp;resumptionToken=rt10130378386093615p9</A>
Wed Feb 06 18:19:51 EST 2002
java.io.IOException: Server returned HTTP response code: 400 for URL:
<A HREF="http://hsss.slub-dresden.de/hsss/servlet/hsss.oai.OAIServlet?verb=ListRecords&resumptionToken=rt10130378386093615p9">http://hsss.slub-dresden.de/hsss/servlet/hsss.oai.OAIServlet?verb=ListRecords&amp;resumptionToken=rt10130378386093615p9</A>

cimi:

<A HREF="http://www.cimi.org/servlet/oai?verb=ListRecords&resumptionToken=5fs9fuzq3mcj471dredxulbv2rjfihmg">http://www.cimi.org/servlet/oai?verb=ListRecords&amp;resumptionToken=5fs9fuzq3mcj471dredxulbv2rjfihmg</A>
Thu Feb 07 01:00:56 EST 2002
java.io.IOException: Server returned HTTP response code: 400 for URL:
<A HREF="http://www.cimi.org/servlet/oai?verb=ListRecords&resumptionToken=5fs9fuzq3mcj471dredxulbv2rjfihmg">http://www.cimi.org/servlet/oai?verb=ListRecords&amp;resumptionToken=5fs9fuzq3mcj471dredxulbv2rjfihmg</A>
responsecode:400

dlpscoll:
<A HREF="http://www.hti.umich.edu/cgi/b/broker/broker?verb=ListRecords&resumptionToken=evd-bib,2200-01-01,1800-01-01,oai_dc,evd-bib,evd-bib.dd,200,">http://www.hti.umich.edu/cgi/b/broker/broker?verb=ListRecords&amp;resumptionToken=evd-bib,2200-01-01,1800-01-01,oai_dc,evd-bib,evd-bib.dd,200,</A>
Thu Feb 07 06:38:05 EST 2002
java.io.IOException: Server returned HTTP response code: 500 for URL:
<A HREF="http://www.hti.umich.edu/cgi/b/broker/broker?verb=ListRecords&resumptionToken=evd-bib,2200-01-01,1800-01-01,oai_dc,evd-bib,evd-bib.dd,200,">http://www.hti.umich.edu/cgi/b/broker/broker?verb=ListRecords&amp;resumptionToken=evd-bib,2200-01-01,1800-01-01,oai_dc,evd-bib,evd-bib.dd,200,</A>
responsecode:500

conoze:
<A HREF="http://www.conoze.com/interfaz/oai/index.php?verb=ListRecords&resumptionToken=50">http://www.conoze.com/interfaz/oai/index.php?verb=ListRecords&amp;resumptionToken=50</A>
Sun Mar 03 07:34:50 EST 2002
java.io.IOException: Server returned HTTP response code: 400 for URL:
<A HREF="http://www.conoze.com/interfaz/oai/index.php?verb=ListRecords&resumptionToken=50">http://www.conoze.com/interfaz/oai/index.php?verb=ListRecords&amp;resumptionToken=50</A>


regards,
liu



&gt;<i>  
</I>&gt;<i> &gt; Ideally, I guess a harvester could use exponential backoff algorithm to
</I>&gt;<i> &gt; keep trying until the resumptionToken is expired (Considering a
</I>&gt;<i> &gt; time-to-live parameter will be added in 2.0). And if we implment the
</I>&gt;<i> &gt; harvester in a multiple process/thread way, the system should scale well
</I>&gt;<i> &gt; for several resumptionToken errors.
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; I think something like &quot;implementation guide&quot; or &quot;reference
</I>&gt;<i> &gt; implementation&quot; will help harvester and DP understand each other well
</I>&gt;<i> &gt; beyond the core protocol.
</I>&gt;<i> 
</I>&gt;<i> Yes, this should certainly be covered in the implementation guidelines.
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Simeon.
</I>&gt;<i>  
</I>&gt;<i> 
</I>&gt;<i> &gt; regards,
</I>&gt;<i> &gt; liu
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; I'm sure ETDCat needs more stress testing to minimize future failures. The
</I>&gt;<i> &gt; &gt; fact that we've discussed this before, though, indicates a recognition that
</I>&gt;<i> &gt; &gt; problems can happen. I don't blame Alan if he doesn't want to negotiate
</I>&gt;<i> &gt; &gt; special rules for harvesting ETDCat merely because the risk is proportional
</I>&gt;<i> &gt; &gt; to the size of the repository.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Jeff
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; -----Original Message-----
</I>&gt;<i> &gt; &gt; From: Michael L. Nelson [mailto:<A HREF="mailto:mln@ils.unc.edu">mln@ils.unc.edu</A>]
</I>&gt;<i> &gt; &gt; Sent: Tuesday, March 05, 2002 10:03 AM
</I>&gt;<i> &gt; &gt; To: 'Alan Kent'
</I>&gt;<i> &gt; &gt; Cc: OAI Implementors
</I>&gt;<i> &gt; &gt; Subject: Re: [OAI-implementers] Better resumption mechanism - more
</I>&gt;<i> &gt; &gt; important than ever!
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; actually, the way I see it is the protocol should not be complicated with
</I>&gt;<i> &gt; &gt; additional tokens and such to enforce what ETDCat (and similiarly
</I>&gt;<i> &gt; &gt; large-sized DPs) should do:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 1.  partition their collection into sets
</I>&gt;<i> &gt; &gt; 2.  use stateless (or very long lived) resumptionTokens
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; in 2.0, resumptionTokens will have optional attributes, including
</I>&gt;<i> &gt; &gt; &quot;expirationDate&quot;, so this will take the guess work out of knowing how long
</I>&gt;<i> &gt; &gt; a resumptionToken will be valid.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; IMO, introducing an optional restartToken is no different (from an
</I>&gt;<i> &gt; &gt; implementer's point of view) than making the resumptionToken last a long
</I>&gt;<i> &gt; &gt; time.  
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; at some point, you (as a harvester) are simply at the mercy of the
</I>&gt;<i> &gt; &gt; repository.  new features in the protocol won't change that.
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; regards,
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; Michael
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; On Tue, 5 Mar 2002, 'Alan Kent' wrote:
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; I just got some mail from Jeff at OCLC talking about ETDCat (hope
</I>&gt;<i> &gt; &gt; &gt; you don't mind me quoting some of your mail Jeff). In particular,
</I>&gt;<i> &gt; &gt; &gt; he just told me
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt;     ETDCat contains a lot of records (over 4 million), all of
</I>&gt;<i> &gt; &gt; &gt;     which currently have the exact same datestamp from the initial load.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; He also told me that there were no sets. So basically, its all
</I>&gt;<i> &gt; &gt; &gt; or nothing for this site because OAI has no standard way to resume
</I>&gt;<i> &gt; &gt; &gt; if a transfer fails.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; If this has happened already, I think its likely to occur again.
</I>&gt;<i> &gt; &gt; &gt; (That is, one very large database all with the same time stamp.)
</I>&gt;<i> &gt; &gt; &gt; So any comments about having a single large collection like this
</I>&gt;<i> &gt; &gt; &gt; is beside the point. The point is OAI does not handle it well.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; So I would like to resurrect the discussion again if people don't
</I>&gt;<i> &gt; &gt; &gt; mind on how to do support restarts. My understanding of the general
</I>&gt;<i> &gt; &gt; &gt; feeling so far is
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; (1) Mandating support is not going to be acceptable
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; (2) Mandating format of resumption tokens is not going to be acceptable
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; (3) Mandating resumption tokens be long lifed (eg: can try again the
</I>&gt;<i> &gt; &gt; &gt;     following day) is not acceptable
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; (4) In fact, mandating that resumption tokens be unique (allowing
</I>&gt;<i> &gt; &gt; &gt;     a token to be reused twice in quick succession to get the same
</I>&gt;<i> &gt; &gt; &gt;     data) is not acceptable
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; So any proposal needs to be optionally supported.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Question time:
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Does anyone else think that this is a major hole in OAI? I personally
</I>&gt;<i> &gt; &gt; &gt; do. After trying to crawl sites, things go wrong. The larger the site,
</I>&gt;<i> &gt; &gt; &gt; the greater the probability that something will go wrong. The larger
</I>&gt;<i> &gt; &gt; &gt; the site, the greater the pain of starting all over again. I do not
</I>&gt;<i> &gt; &gt; &gt; think it is practical for anyone to harvest ETDCat if is really got
</I>&gt;<i> &gt; &gt; &gt; 4,000,000 records. Any fault, and start downloading that 4gb again!
</I>&gt;<i> &gt; &gt; &gt; So I feel strongly on this one. In fact, I think this is the most
</I>&gt;<i> &gt; &gt; &gt; major problem OAI has.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Do people think its better to reuse resumption tokens for this purpose,
</I>&gt;<i> &gt; &gt; &gt; or introduce a different sort of token? ETDCat for example I think
</I>&gt;<i> &gt; &gt; &gt; allocates a session id in resumption tokens, meaning they cannot
</I>&gt;<i> &gt; &gt; &gt; be reused when the session times out in the server (similar semantics
</I>&gt;<i> &gt; &gt; &gt; anyway). This is a reasonable implementation decision to make.
</I>&gt;<i> &gt; &gt; &gt; So maybe its better for servers to return an additional token,
</I>&gt;<i> &gt; &gt; &gt; which is a &lt;restartToken&gt; which means a client can instead of
</I>&gt;<i> &gt; &gt; &gt; specifying from= and to= again, specify restartToken= instead where
</I>&gt;<i> &gt; &gt; &gt; the server then automatically works out whatever other parameters
</I>&gt;<i> &gt; &gt; &gt; it needs, creates a new session etc internally. The new 'session'
</I>&gt;<i> &gt; &gt; &gt; (ListXXX verb) then can use resumptionTokens to manage that new
</I>&gt;<i> &gt; &gt; &gt; transfer.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; The idea is for a &lt;restartToken&gt; to be long lifed. It may be less
</I>&gt;<i> &gt; &gt; &gt; efficient to use than a resumptionToken, but its only purpose is
</I>&gt;<i> &gt; &gt; &gt; if the client fails the download. If a server does not support
</I>&gt;<i> &gt; &gt; &gt; restartToken, it simply never returns one. Large collections *should*
</I>&gt;<i> &gt; &gt; &gt; support restartTokens.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; For my harvester, I can then remember (to disk) the restartToken for
</I>&gt;<i> &gt; &gt; &gt; every packet I get back, allowing me to recover much more easily
</I>&gt;<i> &gt; &gt; &gt; if anything crashes. If restartToken's are too hard for someone
</I>&gt;<i> &gt; &gt; &gt; to implement, then they don't. If you have a large data collection
</I>&gt;<i> &gt; &gt; &gt; on the other hand, to reduce network load, I think its probably worth
</I>&gt;<i> &gt; &gt; &gt; the extra effort of supporting restartTokens.
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Any comments? Better suggesions?
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; &gt; Alan
</I>&gt;<i> &gt; &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; &gt; OAI-implementers mailing list
</I>&gt;<i> &gt; &gt; &gt; <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> &gt; &gt; &gt; <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> &gt; &gt; &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; ---
</I>&gt;<i> &gt; &gt; Michael L. Nelson
</I>&gt;<i> &gt; &gt; NASA Langley Research Center		<A HREF="mailto:m.l.nelson@larc.nasa.gov">m.l.nelson@larc.nasa.gov</A>
</I>&gt;<i> &gt; &gt; MS 158, Hampton, VA 23681		<A HREF="http://www.ils.unc.edu/~mln/">http://www.ils.unc.edu/~mln/</A>
</I>&gt;<i> &gt; &gt; +1 757 864 8511				+1 757 864 8342 (f)
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; OAI-implementers mailing list
</I>&gt;<i> &gt; &gt; <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> &gt; &gt; _______________________________________________
</I>&gt;<i> &gt; &gt; OAI-implementers mailing list
</I>&gt;<i> &gt; &gt; <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> &gt; &gt; <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> &gt; &gt; 
</I>&gt;<i> &gt; 
</I>&gt;<i> &gt; _______________________________________________
</I>&gt;<i> &gt; OAI-implementers mailing list
</I>&gt;<i> &gt; <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> &gt; <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> &gt; 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OAI-implementers mailing list
</I>&gt;<i> <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000412.html">[OAI-implementers] Better resumption mechanism - more importa
 nt than ever!
</A></li>
	<LI> Next message: <A HREF="000415.html">[OAI-implementers] Better resumption mechanism - more importa nt than ever!
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#414">[ date ]</a>
              <a href="thread.html#414">[ thread ]</a>
              <a href="subject.html#414">[ subject ]</a>
              <a href="author.html#414">[ author ]</a>
         </LI>
       </UL>
</body></html>
