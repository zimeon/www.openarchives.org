<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OAI-implementers] XML encoding problems with DSpace at MIT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:hussein%40cs.uct.ac.za">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000762.html">
   <LINK REL="Next"  HREF="000767.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OAI-implementers] XML encoding problems with DSpace at MIT
   </H1>
    <B>Hussein Suleman
    </B> 
    <A HREF="mailto:hussein%40cs.uct.ac.za"
       TITLE="[OAI-implementers] XML encoding problems with DSpace at MIT">hussein@cs.uct.ac.za
       </A><BR>
    <I>Sat, 15 Feb 2003 17:23:46 +0200</I>
    <P><UL>
        <LI> Previous message: <A HREF="000762.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
        <LI> Next message: <A HREF="000767.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#766">[ date ]</a>
              <a href="thread.html#766">[ thread ]</a>
              <a href="subject.html#766">[ subject ]</a>
              <a href="author.html#766">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>hi

i think Tim poses a very relevant question: do we deal with the 
so-called &quot;real-world&quot; encoding problems or do we try to encourage 
people to fix their implementations? (of course, for research purposes, 
we may end up doing both :))

personally, the code i distribute to others does quite a lot of XML 
cleaning in the data provider, but none at all in the harvester. i think 
the basic philosophy i'm following is: clean data as close to the source 
as possible. also, i believe one of the reasons the adminEmail field in 
Identify responses is required is so that a service provider can contact 
the administrator if there are problems with the data.

and now that the hype about OAI2 is dying down, i wonder how much (if 
any) more testing we need. i have some ideas to enhance, complement and 
possibly even replace the repository explorer in the next year ... it 
all depends on finding time and/or students/colleagues with time :)

ttfn,
----hussein


Tim Brody wrote:
&gt;<i> <A HREF="http://celestial.eprints.org/cgi-bin/status?action=repository;metadataFormat=17">http://celestial.eprints.org/cgi-bin/status?action=repository;metadataFormat=17</A> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> Harvested 752 records - I've also implemented some 
</I>&gt;<i> character-substitution to fix encoding errors, although this is probably 
</I>&gt;<i> not as proficient as Simeon's!
</I>&gt;<i> 
</I>&gt;<i> The question is, the more harvesters implement fixes the less pressure 
</I>&gt;<i> there is on repositories to fix their output, so should harvesters 
</I>&gt;<i> accept bad-XML?
</I>&gt;<i> (once that question is answered, harvesters have to decide how much 
</I>&gt;<i> normalisation of metadata they do :-)
</I>&gt;<i> 
</I>&gt;<i> All the best,
</I>&gt;<i> Tim.
</I>&gt;<i> 
</I>&gt;<i> Simeon Warner wrote:
</I>&gt;<i> 
</I>&gt;&gt;<i> In my recent post to oai-general
</I>&gt;&gt;<i> <A HREF="http://www.openarchives.org/pipermail/oai-general/2003-February/000258.html">http://www.openarchives.org/pipermail/oai-general/2003-February/000258.html</A> 
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> I said I'd post a note about the current output of DSpace at MIT to this
</I>&gt;&gt;<i> list (which seems a more appropriate forum). I just ran a harvest and got
</I>&gt;&gt;<i> the log shown below, I've added comments in [].
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> Cheers,
</I>&gt;&gt;<i> Simeon.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;more log oaiharvest.pl: Harvest from 
</I>&gt;&gt;<i> <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> using POST
</I>&gt;&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: verb=Identify
</I>&gt;&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;&gt;<i> OAIGet: Got 200 OK (627bytes decoded to 1328bytes)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [nice, DSpace implements gzip content coding]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> oaiharvest.pl: Identify reports OAI-PMH version 2.0
</I>&gt;&gt;<i> oaiharvest.pl: Doing complete harvest.
</I>&gt;&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: 
</I>&gt;&gt;<i> verb=ListMetadataFormats
</I>&gt;&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;&gt;<i> OAIGet: Got 200 OK (307bytes decoded to 643bytes)
</I>&gt;&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: verb=ListSets
</I>&gt;&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;&gt;<i> OAIGet: Got 200 OK (715bytes decoded to 2140bytes)
</I>&gt;&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: 
</I>&gt;&gt;<i> metadataPrefix=oai_dc&amp;verb=ListRecords
</I>&gt;&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;&gt;<i> OAIGet: Got 200 OK (254096bytes decoded to 1392720bytes)
</I>&gt;&gt;<i> oaiharvest.pl: UTF-8/XML errors in ListRecords.1:
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [oops, expat parser fails on response
</I>&gt;&gt;<i>  my harvester now attempts to do replacement on bad XML/UTF8 bytes/chars
</I>&gt;&gt;<i>  using my utf8conditioner, details at 
</I>&gt;&gt;<i>  <A HREF="http://www.cs.cornell.edu/people/simeon/software/utf8conditioner/">http://www.cs.cornell.edu/people/simeon/software/utf8conditioner/</A> 
</I>&gt;&gt;<i>  Unless the response can be parsed we can't even know if there is a
</I>&gt;&gt;<i>  resumptionToken...]
</I>&gt;&gt;<i> utf8conditioner: Line 320, char 81453, byte 81491: code not allowed in 
</I>&gt;&gt;<i> XML: 0x000C, substituted 0x3F
</I>&gt;&gt;<i> Line 324, char 81713, byte 81751: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1839, char 559834, byte 559890: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1840, char 559919, byte 559975: code not allowed in XML: 0x000C, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1843, char 560213, byte 560269: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1846, char 560475, byte 560531: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1850, char 560807, byte 560863: code not allowed in XML: 0x000C, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 1851, char 560911, byte 560967: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2249, char 658132, byte 658188: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2250, char 658230, byte 658286: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2253, char 658449, byte 658505: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2271, char 662207, byte 662263: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2274, char 662411, byte 662467: code not allowed in XML: 0x000E, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> Line 2287, char 663373, byte 663429: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [utf8conditioner detected and did replacements for a number of 
</I>&gt;&gt;<i> characeters]
</I>&gt;&gt;<i> oaiharvest.pl: Got 752 records (running total: 752)
</I>&gt;&gt;<i> oaiharvest.pl: No resumptionToken, end of complete list.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [expat could then parse response extracting 752 records, no 
</I>&gt;&gt;<i> resumptionToken]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> oaiharvest.pl: Done.
</I>&gt;&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> [doing the same tests with Xerces...]
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;xercesCountElements lr
</I>&gt;&gt;<i> [Fatal Error] lr:320:76: An invalid XML character (Unicode: 0xc) was 
</I>&gt;&gt;<i> found in the element content of the document.
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;cat lr | utf8conditioner -x &gt; lrc
</I>&gt;&gt;<i> Line 320, char 81453, byte 81491: code not allowed in XML: 0x000C, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i> [..etc, same output as above...]
</I>&gt;&gt;<i> Line 2287, char 663373, byte 663429: code not allowed in XML: 0x000B, 
</I>&gt;&gt;<i> substituted 0x3F
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;xercesCountElements lrc
</I>&gt;&gt;<i> lrc: 4665;519;10 ms (18104 elems, 3013 attrs, 0 spaces, 740197 chars)
</I>&gt;&gt;<i>
</I>&gt;&gt;<i>
</I>&gt;&gt;<i> _______________________________________________
</I>&gt;&gt;<i> OAI-implementers mailing list
</I>&gt;&gt;<i> <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;&gt;<i> <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;&gt;<i>
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OAI-implementers mailing list
</I>&gt;<i> <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>

-- 
=====================================================================
hussein suleman ~ <A HREF="mailto:hussein@cs.uct.ac.za">hussein@cs.uct.ac.za</A> ~ <A HREF="http://www.husseinsspace.com">http://www.husseinsspace.com</A>
=====================================================================



</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000762.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
	<LI> Next message: <A HREF="000767.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#766">[ date ]</a>
              <a href="thread.html#766">[ thread ]</a>
              <a href="subject.html#766">[ subject ]</a>
              <a href="author.html#766">[ author ]</a>
         </LI>
       </UL>
</body></html>
