<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2//EN">
<HTML>
 <HEAD>
   <TITLE> [OAI-implementers] XML encoding problems with DSpace at MIT
   </TITLE>
   <LINK REL="Index" HREF="index.html" >
   <LINK REL="made" HREF="mailto:tim%40tim.brody.btinternet.co.uk">
   <META NAME="robots" CONTENT="index,nofollow">
   
   <LINK REL="Previous"  HREF="000761.html">
   <LINK REL="Next"  HREF="000766.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[OAI-implementers] XML encoding problems with DSpace at MIT
   </H1>
    <B>Tim Brody
    </B> 
    <A HREF="mailto:tim%40tim.brody.btinternet.co.uk"
       TITLE="[OAI-implementers] XML encoding problems with DSpace at MIT">tim@tim.brody.btinternet.co.uk
       </A><BR>
    <I>Sat, 15 Feb 2003 14:52:50 +0000</I>
    <P><UL>
        <LI> Previous message: <A HREF="000761.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
        <LI> Next message: <A HREF="000766.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#762">[ date ]</a>
              <a href="thread.html#762">[ thread ]</a>
              <a href="subject.html#762">[ subject ]</a>
              <a href="author.html#762">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE><A HREF="http://celestial.eprints.org/cgi-bin/status?action=repository;metadataFormat=17">http://celestial.eprints.org/cgi-bin/status?action=repository;metadataFormat=17</A>

Harvested 752 records - I've also implemented some 
character-substitution to fix encoding errors, although this is probably 
not as proficient as Simeon's!

The question is, the more harvesters implement fixes the less pressure 
there is on repositories to fix their output, so should harvesters 
accept bad-XML?
(once that question is answered, harvesters have to decide how much 
normalisation of metadata they do :-)

All the best,
Tim.

Simeon Warner wrote:
&gt;<i> In my recent post to oai-general
</I>&gt;<i> <A HREF="http://www.openarchives.org/pipermail/oai-general/2003-February/000258.html">http://www.openarchives.org/pipermail/oai-general/2003-February/000258.html</A>
</I>&gt;<i> I said I'd post a note about the current output of DSpace at MIT to this
</I>&gt;<i> list (which seems a more appropriate forum). I just ran a harvest and got
</I>&gt;<i> the log shown below, I've added comments in [].
</I>&gt;<i> 
</I>&gt;<i> Cheers,
</I>&gt;<i> Simeon.
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;more log 
</I>&gt;<i> oaiharvest.pl: Harvest from <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> using POST
</I>&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: verb=Identify
</I>&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;<i> OAIGet: Got 200 OK (627bytes decoded to 1328bytes)
</I>&gt;<i> 
</I>&gt;<i> [nice, DSpace implements gzip content coding]
</I>&gt;<i> 
</I>&gt;<i> oaiharvest.pl: Identify reports OAI-PMH version 2.0
</I>&gt;<i> oaiharvest.pl: Doing complete harvest.
</I>&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: verb=ListMetadataFormats
</I>&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;<i> OAIGet: Got 200 OK (307bytes decoded to 643bytes)
</I>&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: verb=ListSets
</I>&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;<i> OAIGet: Got 200 OK (715bytes decoded to 2140bytes)
</I>&gt;<i> OAIGet: Doing POST to <A HREF="http://hpds1.mit.edu/oai/">http://hpds1.mit.edu/oai/</A> args: metadataPrefix=oai_dc&amp;verb=ListRecords
</I>&gt;<i> OAIGet: Note - Got Content-Encoding 'gzip', decoded with 'gunzip -c'
</I>&gt;<i> OAIGet: Got 200 OK (254096bytes decoded to 1392720bytes)
</I>&gt;<i> oaiharvest.pl: UTF-8/XML errors in ListRecords.1:
</I>&gt;<i> 
</I>&gt;<i> [oops, expat parser fails on response
</I>&gt;<i>  my harvester now attempts to do replacement on bad XML/UTF8 bytes/chars
</I>&gt;<i>  using my utf8conditioner, details at 
</I>&gt;<i>  <A HREF="http://www.cs.cornell.edu/people/simeon/software/utf8conditioner/">http://www.cs.cornell.edu/people/simeon/software/utf8conditioner/</A> 
</I>&gt;<i>  Unless the response can be parsed we can't even know if there is a
</I>&gt;<i>  resumptionToken...] 
</I>&gt;<i> 
</I>&gt;<i> utf8conditioner: 
</I>&gt;<i> Line 320, char 81453, byte 81491: code not allowed in XML: 0x000C, substituted 0x3F
</I>&gt;<i> Line 324, char 81713, byte 81751: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 1839, char 559834, byte 559890: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 1840, char 559919, byte 559975: code not allowed in XML: 0x000C, substituted 0x3F
</I>&gt;<i> Line 1843, char 560213, byte 560269: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 1846, char 560475, byte 560531: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 1850, char 560807, byte 560863: code not allowed in XML: 0x000C, substituted 0x3F
</I>&gt;<i> Line 1851, char 560911, byte 560967: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 2249, char 658132, byte 658188: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 2250, char 658230, byte 658286: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 2253, char 658449, byte 658505: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 2271, char 662207, byte 662263: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> Line 2274, char 662411, byte 662467: code not allowed in XML: 0x000E, substituted 0x3F
</I>&gt;<i> Line 2287, char 663373, byte 663429: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> 
</I>&gt;<i> [utf8conditioner detected and did replacements for a number of characeters] 
</I>&gt;<i> 
</I>&gt;<i> oaiharvest.pl: Got 752 records (running total: 752)
</I>&gt;<i> oaiharvest.pl: No resumptionToken, end of complete list.
</I>&gt;<i> 
</I>&gt;<i> [expat could then parse response extracting 752 records, no resumptionToken]
</I>&gt;<i> 
</I>&gt;<i> oaiharvest.pl: Done.
</I>&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> [doing the same tests with Xerces...]
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;xercesCountElements lr
</I>&gt;<i> [Fatal Error] lr:320:76: An invalid XML character (Unicode: 0xc) was found in the element content of the document.
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;cat lr | utf8conditioner -x &gt; lrc
</I>&gt;<i> Line 320, char 81453, byte 81491: code not allowed in XML: 0x000C, substituted 0x3F
</I>&gt;<i> [..etc, same output as above...]
</I>&gt;<i> Line 2287, char 663373, byte 663429: code not allowed in XML: 0x000B, substituted 0x3F
</I>&gt;<i> 
</I>&gt;<i> <A HREF="mailto:simeon@ice">simeon@ice</A> 14Feb03&gt;xercesCountElements lrc
</I>&gt;<i> lrc: 4665;519;10 ms (18104 elems, 3013 attrs, 0 spaces, 740197 chars)
</I>&gt;<i> 
</I>&gt;<i> 
</I>&gt;<i> _______________________________________________
</I>&gt;<i> OAI-implementers mailing list
</I>&gt;<i> <A HREF="mailto:OAI-implementers@oaisrv.nsdl.cornell.edu">OAI-implementers@oaisrv.nsdl.cornell.edu</A>
</I>&gt;<i> <A HREF="http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers">http://oaisrv.nsdl.cornell.edu/mailman/listinfo/oai-implementers</A>
</I>&gt;<i> 
</I>

</PRE>
<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI> Previous message: <A HREF="000761.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
	<LI> Next message: <A HREF="000766.html">[OAI-implementers] XML encoding problems with DSpace at MIT
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#762">[ date ]</a>
              <a href="thread.html#762">[ thread ]</a>
              <a href="subject.html#762">[ subject ]</a>
              <a href="author.html#762">[ author ]</a>
         </LI>
       </UL>
</body></html>
